<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta http-equiv="content-style-type" content="text/css" />
<title>Docs For Class Net_DNSBL_SURBL</title>
<link rel="stylesheet" type="text/css" href="../media/style.css" />
<link rel="start" href="./index.html" title="API Documentation" />
<link rev="made" href="mailto:webmaster@anti-spam.example.com" />
</head>
<body>

<!-- Begin #header -->
<div id="header">
<h1 id="top">Net_DNSBL</h1>
<div id="header-menu">
<a href="../classtrees_Net_DNSBL.html" class="menu">class tree: Net_DNSBL</a> 
<a href="../elementindex_Net_DNSBL.html" class="menu">index: Net_DNSBL</a> 
<a href="../elementindex.html" class="menu">all elements</a>
</div>
</div>

<!-- Begin #menu -->
<div id="menu">
<h2>Packages:</h2>
<ul>
<li><a href="../li_default.html">default</a></li>
<li><a href="../li_BitWiki.html">BitWiki</a></li>
<li><a href="../li_Cache_Lite.html">Cache_Lite</a></li>
<li><a href="../li_HTTP_Request.html">HTTP_Request</a></li>
<li><a href="../li_Net_CheckIP.html">Net_CheckIP</a></li>
<li><a href="../li_Net_DNSBL.html">Net_DNSBL</a></li>
<li><a href="../li_PEAR.html">PEAR</a></li>
<li><a href="../li_Smarty.html">Smarty</a></li>
<li><a href="../li_Text_Diff.html">Text_Diff</a></li>
<li><a href="../li_Text_Highlighter.html">Text_Highlighter</a></li>
<li><a href="../li_Trackback.html">Trackback</a></li>
</ul>
<h2>Files:</h2>
<div class="package">
<ul>
<li><a href="../Net_DNSBL/_library---pear---Net---DNSBL.php.html">DNSBL.php</a></li><li><a href="../Net_DNSBL/_library---pear---Net---DNSBL---SURBL.php.html">SURBL.php</a></li></ul>
</div>
<h2>Classes:</h2>
<div class="package">
<ul>
<li><a href="../Net_DNSBL/Net_DNSBL.html">Net_DNSBL</a></li><li><a href="../Net_DNSBL/Net_DNSBL_SURBL.html">Net_DNSBL_SURBL</a></li></ul>
</div>
</div>

<!-- Begin #content -->
<div id="content">
<div id="content-title">
<h2>Class: Net_DNSBL_SURBL</h2>
<p>Source Location: /library/pear/Net/DNSBL/SURBL.php</p>
</div>


<div id="overview">
<h3><a href="#class_details">Class Overview</a></h3>
<pre><a href="../Net_DNSBL/Net_DNSBL.html">Net_DNSBL</a>
   |
   --Net_DNSBL_SURBL</pre>






</div><!-- End #overview -->

<div id="variables">
<h3><a href="#class_vars">Variables</a></h3>
<ul>
    <li><a href="../Net_DNSBL/Net_DNSBL_SURBL.html#var$blacklists">$blacklists</a></li>
    <li><a href="../Net_DNSBL/Net_DNSBL_SURBL.html#var$doubleCcTldFile">$doubleCcTldFile</a></li>
    <li><a href="../Net_DNSBL/Net_DNSBL_SURBL.html#var$twoLevelCcTld">$twoLevelCcTld</a></li>
  </ul>
</div>


<div id="methods">
<h3><a href="#class_methods">Methods</a></h3>
<ul>
    <li><a href="../Net_DNSBL/Net_DNSBL_SURBL.html#methodgetHostForLookup">getHostForLookup</a></li>
    <li><a href="../Net_DNSBL/Net_DNSBL_SURBL.html#methodisDoubleCcTld">isDoubleCcTld</a></li>
  </ul>
</div>






<div id="inherited-methods">
<h3>Inherited Methods</h3>
<div class="tags">
<h4>Class: <a href="../Net_DNSBL/Net_DNSBL.html">Net_DNSBL</a></h4>
<dl>
    <dt>
    <a href="../Net_DNSBL/Net_DNSBL.html#methodbuildLookUpHost">Net_DNSBL::buildLookUpHost()</a>
  </dt>
  <dd>
    Build the host to lookup from an IP.
  </dd>
    <dt>
    <a href="../Net_DNSBL/Net_DNSBL.html#methodgetBlacklists">Net_DNSBL::getBlacklists()</a>
  </dt>
  <dd>
    Get the blacklists.
  </dd>
    <dt>
    <a href="../Net_DNSBL/Net_DNSBL.html#methodgetHostForLookup">Net_DNSBL::getHostForLookup()</a>
  </dt>
  <dd>
    Get host to lookup. Lookup a host if neccessary and get the  complete FQDN to lookup.
  </dd>
    <dt>
    <a href="../Net_DNSBL/Net_DNSBL.html#methodisListed">Net_DNSBL::isListed()</a>
  </dt>
  <dd>
    Checks if the supplied Host is listed in one or more of the  RBLs.
  </dd>
    <dt>
    <a href="../Net_DNSBL/Net_DNSBL.html#methodreverseIp">Net_DNSBL::reverseIp()</a>
  </dt>
  <dd>
    Reverse the order of an IP. 127.0.0.1 -&gt; 1.0.0.127. Currently  only works for v4-adresses
  </dd>
    <dt>
    <a href="../Net_DNSBL/Net_DNSBL.html#methodsetBlacklists">Net_DNSBL::setBlacklists()</a>
  </dt>
  <dd>
    Set the blacklist to a desired blacklist.
  </dd>
  </dl>
</div>
</div>

<div id="class_details">
<h3>Class Details</h3>
<div class="tags">
[line 39]<br />
</div>
<p class="top">[ <a href="#top">Top</a> ]</p>
</div>

<div id="class_vars">
<h3>Class Variables</h3>
<div class="tags">
<h4 id="var$blacklists">$blacklists = <span class="value">array('multi.surbl.org')</span></h4>
<p>[line 49]</p>
<p>Array of blacklists.</p>Must have one or more elements.<h4>Tags:</h4>
<div class="tags">
<table summary="tags" class="tags">
<tr>
<td><strong>access:</strong></td><td>protected</td>
</tr>
</table>
</div>
<div class="tags">
<table summary="tags" class="tags">
<tr>
<td><strong>Type:</strong></td>
<td>string[]</td>
</tr>
<tr>
<td><strong>Overrides:</strong></td>
<td>Array</td>
</tr>
</table>
</div>
<div class="top">[ <a href="#top">Top</a> ]</div>
<h4 id="var$doubleCcTldFile">$doubleCcTldFile = <span class="value">'http://spamcheck.freeapp.net/two-level-tlds'</span></h4>
<p>[line 62]</p>
<p>File containing whitelisted hosts.</p>There are some whitelisted hosts (co.uk for example). This  requires the package to not ask the domain name but the host  name (spammer.co.uk instead of co.uk).<h4>Tags:</h4>
<div class="tags">
<table summary="tags" class="tags">
<tr>
<td><strong>see:</strong></td><td><a href="../Net_DNSBL/Net_DNSBL_SURBL.html#var$twoLevelCcTld">Net_DNSBL_SURBL::$twoLevelCcTld</a></td>
</tr>
<tr>
<td><strong>access:</strong></td><td>protected</td>
</tr>
</table>
</div>
<div class="tags">
<table summary="tags" class="tags">
<tr>
<td><strong>Type:</strong></td>
<td>string</td>
</tr>
</table>
</div>
<div class="top">[ <a href="#top">Top</a> ]</div>
<h4 id="var$twoLevelCcTld">$twoLevelCcTld = <span class="value">array()</span></h4>
<p>[line 71]</p>
<p>Array of whitelisted hosts.</p><h4>Tags:</h4>
<div class="tags">
<table summary="tags" class="tags">
<tr>
<td><strong>see:</strong></td><td>$twoLevelCcTldFile</td>
</tr>
<tr>
<td><strong>access:</strong></td><td>private</td>
</tr>
</table>
</div>
<div class="tags">
<table summary="tags" class="tags">
<tr>
<td><strong>Type:</strong></td>
<td>array</td>
</tr>
</table>
</div>
<div class="top">[ <a href="#top">Top</a> ]</div>
</div>
</div>

<div id="class_methods">
<h3>Class Methods</h3>
<div class="tags">

<!-- Begin .method -->
<div class="method">
<h3 id="methodgetHostForLookup">method getHostForLookup <span class="smalllinenumber">[line 126]</span></h3>
<!-- Begin .code -->
<div class="code">
<code>string getHostForLookup(
string
$uri, 
$blacklist)</code>
</div><!-- End .code -->

<!-- Begin docblock.tpl -->
<p>Get Hostname to ask for.</p>Performs the following steps:(1) Extract the hostname from the given URI  (2) Check if the &quot;hostname&quot; is an ip  (3a) IS_IP Reverse the IP (1.2.3.4 -&gt; 4.3.2.1)  (3b) IS_FQDN Check if is in &quot;CC-2-level-TLD&quot;  (3b1) IS_IN_2LEVEL: we want the last three names  (3b2) IS_NOT_2LEVEL: we want the last two names  (4) return the FQDN to query.<h4>Tags:</h4>
<div class="tags">
<table summary="tags" class="tags">
<tr>
<td><strong>return:</strong></td><td>Host to lookup</td>
</tr>
<tr>
<td><strong>access:</strong></td><td>protected</td>
</tr>
</table>
</div>
<!-- End docblock.tpl -->

Overrides <a href="../Net_DNSBL/Net_DNSBL.html#methodgetHostForLookup">Net_DNSBL::getHostForLookup()</a> (Get host to lookup. Lookup a host if neccessary and get the  complete FQDN to lookup.)<br />
<h4>Parameters:</h4>
<div class="tags">
<table summary="Parameters" class="tags">
<tr>
<td class="type">string</td>
<td><strong><var>$uri</var></strong></td>
<td>URL to check.</td>
</tr>
<tr>
<td class="type"></td>
<td><strong><var>$blacklist</var></strong></td>
<td></td>
</tr>
</table>
</div><!-- End .tags -->
<p class="top">[ <a href="#top">Top</a> ]</p>
</div><!-- End .method -->


<!-- Begin .method -->
<div class="method">
<h3 id="methodisDoubleCcTld">method isDoubleCcTld <span class="smalllinenumber">[line 80]</span></h3>
<!-- Begin .code -->
<div class="code">
<code>boolean isDoubleCcTld(
string
$fqdn)</code>
</div><!-- End .code -->

<!-- Begin docblock.tpl -->
<p>Check if the last two parts of the FQDN are whitelisted.</p><h4>Tags:</h4>
<div class="tags">
<table summary="tags" class="tags">
<tr>
<td><strong>return:</strong></td><td>True if the host is whitelisted</td>
</tr>
<tr>
<td><strong>access:</strong></td><td>protected</td>
</tr>
</table>
</div>
<!-- End docblock.tpl -->


<h4>Parameters:</h4>
<div class="tags">
<table summary="Parameters" class="tags">
<tr>
<td class="type">string</td>
<td><strong><var>$fqdn</var></strong></td>
<td>Host to check if it is whitelisted</td>
</tr>
</table>
</div><!-- End .tags -->
<p class="top">[ <a href="#top">Top</a> ]</p>
</div><!-- End .method -->

</div>
</div>


</div><!-- End #content -->

<div class="credit">
<p>Documentation generated on Tue, 18 Aug 2009 22:35:13 +0900 by <a href="http://www.phpdoc.org">phpDocumentor 1.4.2</a></p>
<p><a href="http://validator.w3.org/check/referer">
XHTML 1.0</a></p>
</div>

</body>
</html>